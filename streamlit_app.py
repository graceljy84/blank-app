import streamlit as st

# ì„¸ì…˜ ìƒíƒœ(Session State) ì´ˆê¸°í™”
# 'submitted' í‚¤ê°€ ì„¸ì…˜ ìƒíƒœì— ì—†ìœ¼ë©´ Falseë¡œ ì„¤ì •
if 'submitted' not in st.session_state:
    st.session_state.submitted = False

# MBTI ë¬¸í•­ ë° ì„ íƒì§€
# ê° ë¬¸í•­ì€ ì‚¬ì „(dictionary) í˜•íƒœë¡œ êµ¬ì„±
questions = [
    {
        "question": "1. ì£¼ë§ì„ ë³´ë‚´ëŠ” ë‹¹ì‹ ì˜ ë°©ì‹ì€?",
        "options": ["(E) ì¹œêµ¬ë“¤ê³¼ í•¨ê»˜í•˜ëŠ” íŒŒí‹°ë‚˜ ëª¨ì„", "(I) ì§‘ì—ì„œ ì¡°ìš©íˆ ë³´ë‚´ëŠ” íœ´ì‹"],
        "type": ("E", "I")
    },
    {
        "question": "2. ìƒˆë¡œìš´ ê¸°ìˆ ì„ ë°°ìš¸ ë•Œ ì„ í˜¸í•˜ëŠ” ë°©ë²•ì€?",
        "options": ["(S) êµ¬ì²´ì ì¸ ì˜ˆì œì™€ ì‹¤ì œ ë°ì´í„°ë¥¼ í†µí•´ í•™ìŠµ", "(N) ì „ì²´ì ì¸ ê°œë…ê³¼ ë¯¸ë˜ ê°€ëŠ¥ì„±ì„ ë¨¼ì € íŒŒì•…"],
        "type": ("S", "N")
    },
    {
        "question": "3. íŒ€ í”„ë¡œì íŠ¸ì—ì„œ ê°ˆë“±ì´ ìƒê²¼ì„ ë•Œ ë‹¹ì‹ ì˜ ì„ íƒì€?",
        "options": ["(T) ë…¼ë¦¬ì ì´ê³  ê°ê´€ì ì¸ ì‚¬ì‹¤ì— ê¸°ë°˜í•˜ì—¬ ê²°ì •", "(F) íŒ€ì›ë“¤ì˜ ê°ì •ê³¼ ê´€ê³„ë¥¼ ìš°ì„ ì ìœ¼ë¡œ ê³ ë ¤"],
        "type": ("T", "F")
    },
    {
        "question": "4. ì—¬í–‰ ê³„íšì„ ì„¸ìš¸ ë•Œ ë‹¹ì‹ ì€?",
        "options": ["(J) ì¶œë°œ ì „ ëª¨ë“  ì¼ì •ì„ ê¼¼ê¼¼í•˜ê²Œ ê³„íš", "(P) ê¸°ë³¸ì ì¸ ê³„íšë§Œ ì„¸ìš°ê³  ìƒí™©ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ í–‰ë™"],
        "type": ("J", "P")
    },
    {
        "question": "5. ì²˜ìŒ ë§Œë‚˜ëŠ” ì‚¬ëŒë“¤ê³¼ì˜ ëŒ€í™”ì—ì„œ ë‹¹ì‹ ì€?",
        "options": ["(E) ë¨¼ì € ë‹¤ê°€ê°€ ëŒ€í™”ë¥¼ ì‹œì‘í•˜ëŠ” í¸", "(I) ë‹¤ë¥¸ ì‚¬ëŒì´ ë§ì„ ê±¸ì–´ì£¼ê¸°ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” í¸"],
        "type": ("E", "I")
    },
    {
        "question": "6. ì˜í™”ë¥¼ ë³´ê³  ë‚˜ì„œ ë‹¹ì‹ ì˜ ê°ìƒì€?",
        "options": ["(S) ì˜í™”ì˜ êµ¬ì²´ì ì¸ ì¥ë©´ì´ë‚˜ ëŒ€ì‚¬ë¥¼ ê¸°ì–µ", "(N) ì˜í™”ê°€ ë‹´ê³  ìˆëŠ” ìˆ¨ê²¨ì§„ ì˜ë¯¸ë‚˜ ìƒì§•ì„ ìƒê°"],
        "type": ("S", "N")
    },
    {
        "question": "7. ì¹œêµ¬ê°€ ê³ ë¯¼ì„ í„¸ì–´ë†“ì„ ë•Œ ë‹¹ì‹ ì˜ ë°˜ì‘ì€?",
        "options": ["(T) ë¬¸ì œ í•´ê²°ì„ ìœ„í•œ í˜„ì‹¤ì ì¸ ì¡°ì–¸ì„ ì œê³µ", "(F) ì¹œêµ¬ì˜ ê°ì •ì— ê³µê°í•˜ë©° ìœ„ë¡œì˜ ë§ì„ ê±´ë„´"],
        "type": ("T", "F")
    },
    {
        "question": "8. ì—…ë¬´ë¥¼ ì²˜ë¦¬í•  ë•Œ ì„ í˜¸í•˜ëŠ” ë°©ì‹ì€?",
        "options": ["(J) ë§ˆê° ê¸°í•œì„ ì² ì €íˆ ì§€í‚¤ê³  ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬", "(P) ë§ˆê° ê¸°í•œì— ì„ë°•í–ˆì„ ë•Œ ì§‘ì¤‘í•´ì„œ ì²˜ë¦¬"],
        "type": ("J", "P")
    }
]

# MBTI ìœ í˜•ë³„ í•™ìŠµ ìŠ¤íƒ€ì¼ ì„¤ëª…
learning_styles = {
    "ISTJ": "ì‹¤ìš©ì ì´ê³  ì²´ê³„ì ì¸ í•™ìŠµì„ ì„ í˜¸í•©ë‹ˆë‹¤. êµ¬ì²´ì ì¸ ì‚¬ì‹¤ê³¼ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê¾¸ì¤€íˆ í•™ìŠµí•˜ëŠ” ìŠ¤íƒ€ì¼ì…ë‹ˆë‹¤.",
    "ISFJ": "ì„¸ì‹¬í•˜ê³  ì±…ì„ê°ì´ ê°•í•˜ì—¬, ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ ë„ì›€ì´ ë˜ëŠ” ì§€ì‹ì„ í•™ìŠµí•  ë•Œ ë™ê¸°ë¶€ì—¬ë¥¼ ë°›ìŠµë‹ˆë‹¤.",
    "INFJ": "í†µì°°ë ¥ì´ ë›°ì–´ë‚˜ê³  ì¥ê¸°ì ì¸ ë¹„ì „ì„ ì¤‘ìš”ì‹œí•©ë‹ˆë‹¤. ê¹Šì´ ìˆëŠ” ì´ë¡ ê³¼ ê°œë…ì„ íƒêµ¬í•˜ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤.",
    "INTJ": "ë…ë¦½ì ì´ê³  ë…¼ë¦¬ì ì¸ í•™ìŠµìì…ë‹ˆë‹¤. ë³µì¡í•œ ì´ë¡ ì„ ì²´ê³„ì ìœ¼ë¡œ ë¶„ì„í•˜ê³  ìì‹ ë§Œì˜ ë°©ì‹ìœ¼ë¡œ ì¬êµ¬ì„±í•˜ëŠ” ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤.",
    "ISTP": "ê²½í—˜ì„ í†µí•´ ë°°ìš°ëŠ” ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤. ì§ì ‘ ë¶€ë”ªíˆê³  ì‹œí–‰ì°©ì˜¤ë¥¼ ê²ªìœ¼ë©° ì›ë¦¬ë¥¼ í„°ë“í•˜ëŠ” ì‹¤ìŠµí˜• í•™ìŠµìì…ë‹ˆë‹¤.",
    "ISFP": "í˜¸ê¸°ì‹¬ì´ ë§ê³  ê°œë°©ì ì…ë‹ˆë‹¤. ë”±ë”±í•œ ì´ë¡ ë³´ë‹¤ëŠ” ììœ ë¡œìš´ í™˜ê²½ì—ì„œ ìì‹ ì˜ ê´€ì‹¬ì‚¬ë¥¼ íƒêµ¬í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤.",
    "INFP": "ìì‹ ì˜ ê°€ì¹˜ê´€ê³¼ ì‹ ë…ì— ë¶€í•©í•˜ëŠ” ë‚´ìš©ì„ í•™ìŠµí•  ë•Œ ê°€ì¥ í° í¥ë¯¸ë¥¼ ëŠë‚ë‹ˆë‹¤. ì°½ì˜ì ì´ê³  ì´ìƒì ì¸ ì•„ì´ë””ì–´ë¥¼ ì¢‹ì•„í•©ë‹ˆë‹¤.",
    "INTP": "ì§€ì  í˜¸ê¸°ì‹¬ì´ ì™•ì„±í•œ ë…¼ë¦¬ì ì¸ ì‚¬ìƒ‰ê°€ì…ë‹ˆë‹¤. ë³µì¡í•œ ë¬¸ì œì˜ ì›ë¦¬ë¥¼ íŒŒê³ ë“œëŠ” ê²ƒì„ ì¦ê¸°ë©°, í† ë¡ ì„ í†µí•´ ì•„ì´ë””ì–´ë¥¼ ë°œì „ì‹œí‚µë‹ˆë‹¤.",
    "ESTP": "í™œë™ì ì´ê³  ì‚¬êµì ì…ë‹ˆë‹¤. ì§ì ‘ì ì¸ ê²½í—˜ê³¼ ì‹¤ì œ í™œë™ì„ í†µí•´ ë°°ìš°ëŠ” ê²ƒì„ ì„ í˜¸í•˜ë©°, ì´ë¡ ë³´ë‹¤ëŠ” ì‹¤ì „ì— ê°•í•©ë‹ˆë‹¤.",
    "ESFP": "ì‚¬ëŒë“¤ê³¼ ì–´ìš¸ë¦¬ë©° ë°°ìš°ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤. ê¸ì •ì ì´ê³  ì¬ë¯¸ìˆëŠ” í•™ìŠµ í™˜ê²½ì—ì„œ ê°€ì¥ ë†’ì€ íš¨ìœ¨ì„ ë³´ì…ë‹ˆë‹¤.",
    "ENFP": "ì—´ì •ì ì´ê³  ìƒìƒë ¥ì´ í’ë¶€í•©ë‹ˆë‹¤. ë‹¤ì–‘í•œ ê°€ëŠ¥ì„±ì„ íƒìƒ‰í•˜ê³ , ì°½ì˜ì ì¸ ì•„ì´ë””ì–´ë¥¼ ë‚˜ëˆ„ëŠ” í˜‘ë ¥ í•™ìŠµì„ ì„ í˜¸í•©ë‹ˆë‹¤.",
    "ENTP": "ë„ì „ì ì´ê³  ì¬ì¹˜ ìˆëŠ” í† ë¡ ì„ ì¦ê¹ë‹ˆë‹¤. ê¸°ì¡´ì˜ ë°©ì‹ì— ì˜ë¬¸ì„ ì œê¸°í•˜ê³  ìƒˆë¡œìš´ ì•„ì´ë””ì–´ë¥¼ íƒêµ¬í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤.",
    "ESTJ": "ì²´ê³„ì ì´ê³  íš¨ìœ¨ì ì¸ í•™ìŠµì„ ì¶”êµ¬í•©ë‹ˆë‹¤. ëª©í‘œë¥¼ ì„¤ì •í•˜ê³  ê³„íšì— ë”°ë¼ í•™ìŠµí•˜ë©°, ì‹¤ì§ˆì ì¸ ê²°ê³¼ë¥¼ ì¤‘ìš”ì‹œí•©ë‹ˆë‹¤.",
    "ESFJ": "ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ í˜‘ë ¥í•˜ê³  ë„ìš°ë©° ë°°ìš°ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤. ì¡°í™”ë¡œìš´ í•™ìŠµ ë¶„ìœ„ê¸°ì—ì„œ ë™ê¸°ë¶€ì—¬ë¥¼ ë°›ìŠµë‹ˆë‹¤.",
    "ENFJ": "ì‚¬ëŒë“¤ì˜ ì„±ì¥ì„ ë•ëŠ” ê²ƒì— í° ë³´ëŒì„ ëŠë‚ë‹ˆë‹¤. ë‹¤ë¥¸ ì‚¬ëŒì„ ê°€ë¥´ì¹˜ê±°ë‚˜ ì´ëŒë©´ì„œ ìŠ¤ìŠ¤ë¡œë„ ë°°ìš°ëŠ” ë¦¬ë”í˜• í•™ìŠµìì…ë‹ˆë‹¤.",
    "ENTJ": "ì „ëµì ì´ê³  ëª©í‘œ ì§€í–¥ì ì¸ í•™ìŠµìì…ë‹ˆë‹¤. ì¥ê¸°ì ì¸ ëª©í‘œë¥¼ ì„¸ìš°ê³ , ì´ë¥¼ ë‹¬ì„±í•˜ê¸° ìœ„í•´ íš¨ìœ¨ì ì¸ í•™ìŠµ ê³„íšì„ ìˆ˜ë¦½í•˜ê³  ì‹¤í–‰í•©ë‹ˆë‹¤."
}

# --- ì•± UI êµ¬ì„± ---
st.title("ğŸš€ MBTI í•™ìŠµ ìœ í˜• ì§„ë‹¨")
st.write("ê°„ë‹¨í•œ ì§ˆë¬¸ì„ í†µí•´ ìì‹ ì—ê²Œ ë§ëŠ” í•™ìŠµ ìŠ¤íƒ€ì¼ì„ ì•Œì•„ë³´ì„¸ìš”!")

# ë‹µë³€ì„ ì €ì¥í•  ë¦¬ìŠ¤íŠ¸
answers = []

# st.formì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  ì§ˆë¬¸ì— ë‹µë³€ í›„ í•œ ë²ˆì— ì œì¶œ
with st.form("mbti_form"):
    # ê° ì§ˆë¬¸ì— ëŒ€í•´ ë¼ë””ì˜¤ ë²„íŠ¼ ìƒì„±
    for i, q in enumerate(questions):
        answer = st.radio(q["question"], q["options"], key=f"q{i}")
        answers.append(answer)

    # ì œì¶œ ë²„íŠ¼
    submitted = st.form_submit_button("ê²°ê³¼ í™•ì¸í•˜ê¸°")

# ì œì¶œ ë²„íŠ¼ì´ í´ë¦­ë˜ë©´, st.session_state.submittedë¥¼ Trueë¡œ ë³€ê²½
if submitted:
    st.session_state.submitted = True

# st.session_state.submittedê°€ Trueì¼ ë•Œë§Œ ê²°ê³¼ë¥¼ í‘œì‹œ
if st.session_state.submitted:
    # MBTI ì ìˆ˜ ê³„ì‚°
    scores = {'E': 0, 'I': 0, 'S': 0, 'N': 0, 'T': 0, 'F': 0, 'J': 0, 'P': 0}
    for i, answer in enumerate(answers):
        # ì„ íƒí•œ ì˜µì…˜ì— ë”°ë¼ ìœ í˜• ì ìˆ˜ ì¦ê°€
        selected_option_index = questions[i]["options"].index(answer)
        mbti_type_char = questions[i]["type"][selected_option_index]
        scores[mbti_type_char] += 1

    # ìµœì¢… MBTI ìœ í˜• ê²°ì •
    result = ""
    result += "E" if scores['E'] > scores['I'] else "I"
    result += "S" if scores['S'] > scores['N'] else "N"
    result += "T" if scores['T'] > scores['F'] else "F"
    result += "J" if scores['J'] > scores['P'] else "P"

    # ê²°ê³¼ ì¶œë ¥
    st.subheader(f"ğŸ“ˆ ë‹¹ì‹ ì˜ MBTI í•™ìŠµ ìœ í˜•ì€: {result}")
    st.info(learning_styles.get(result, "ê²°ê³¼ë¥¼ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤."))
    st.success("ì§„ë‹¨ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìì‹ ì—ê²Œ ë§ëŠ” í•™ìŠµ ì „ëµì„ ì„¸ì›Œë³´ì„¸ìš”!")
    
    # ë‹¤ì‹œ ì‹œì‘ ë²„íŠ¼
    if st.button("ë‹¤ì‹œ ì§„ë‹¨í•˜ê¸°"):
        st.session_state.submitted = False
        st.experimental_rerun() # ì•±ì„ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘